/*
 * wifi.c
 */

#include "wifi.h"				/* WiFi module interface */

static XUartPs uart0port; 					/* UART0 port instance */
static XUartPs uart1port; 					/* UART1 port instance */
static bool done = false;					/* UART interrupt status */
static int wifi_mode = CONFIGURE;			/* WiFi module operation mode */

static int updateval;
static int buffcount = 0;					// for receiving
static u8 *charbuff;						// for sending
static u8 pingbuff[sizeof(ping_t)];
static u8 updatebuff[sizeof(update_response_t)];

/*
 * Sends ping message to local server over UART
 */
void send_ping(void);

/*
 * Sends update message to local server over UART
 */
void send_update(void);

/*
 * Changes WiFi mode to reading update request
 */
void changeToRead(void);

/*
 * Handles communication on UART1
 */
void uart1_handler(void *CallBackRef, u32 Event, unsigned int EventData);

/*
 * Handles UART1 communication from keyboard input
 */
void uart1_handler(void *CallBackRef, u32 Event, unsigned int EventData);

/*
 * Handles UART0 communication from WiFi module
 */
void uart0_handler(void *CallBackRef, u32 Event, unsigned int EventData);
